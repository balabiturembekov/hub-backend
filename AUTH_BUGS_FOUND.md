# üêõ –ù–∞–π–¥–µ–Ω–Ω—ã–µ –±–∞–≥–∏ –≤ –º–æ–¥—É–ª–µ Auth

## üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –±–∞–≥–∏

### 1. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞—â–∏—Ç—ã –æ—Ç brute force –∞—Ç–∞–∫ (Rate Limiting)**
**–§–∞–π–ª:** `server/src/auth/auth.controller.ts` (—Å—Ç—Ä–æ–∫–∞ 17-20)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ—Ç rate limiting –¥–ª—è —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ `/auth/login` –∏ `/auth/register`
- –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞
- –ú–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ DoS –∞—Ç–∞–∫–µ –∏–ª–∏ –ø–æ–¥–±–æ—Ä—É –ø–∞—Ä–æ–ª–µ–π

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```typescript
@Post('login')
async login(@Body() dto: LoginDto) {
  return this.authService.login(dto);
}
```

**–†–µ—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å rate limiting middleware –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `@nestjs/throttler`:
```typescript
import { Throttle } from '@nestjs/throttler';

@Post('login')
@Throttle(5, 60) // 5 –ø–æ–ø—ã—Ç–æ–∫ –≤ –º–∏–Ω—É—Ç—É
async login(@Body() dto: LoginDto) {
  return this.authService.login(dto);
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–π (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)

---

### 2. **–ü—Ä–æ–±–ª–µ–º–∞ —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º dummy hash –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç timing attacks**
**–§–∞–π–ª:** `server/src/auth/auth.service.ts` (—Å—Ç—Ä–æ–∫–∞ 121-122)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π bcrypt hash `$2b$10$dummy.hash.to.prevent.timing.attacks.here`
- –≠—Ç–æ—Ç hash –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç—É bcrypt –∏ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –æ—à–∏–±–∫—É –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –≤–µ—Ä—Å–∏—è—Ö bcrypt
- –ú–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —É—Ç–µ—á–∫–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –æ—à–∏–±–∫–∏

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```typescript
} else {
  const dummyHash = '$2b$10$dummy.hash.to.prevent.timing.attacks.here';
  await bcrypt.compare(dto.password, dummyHash);
}
```

**–†–µ—à–µ–Ω–∏–µ:**
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∞–ª–∏–¥–Ω—ã–π bcrypt hash:
```typescript
} else {
  // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∞–ª–∏–¥–Ω—ã–π bcrypt hash –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç timing attacks
  const dummyHash = '$2b$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewY5GyYqBWVHxkd0';
  await bcrypt.compare(dto.password, dummyHash);
}
```

–ò–ª–∏ –ª—É—á—à–µ - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É —Å –≤–∞–ª–∏–¥–Ω—ã–º —Ö–µ—à–µ–º:
```typescript
// –í –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞
const DUMMY_HASH = '$2b$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewY5GyYqBWVHxkd0';

// –í login()
} else {
  await bcrypt.compare(dto.password, DUMMY_HASH);
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–π (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å - –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –æ—à–∏–±–∫–∏)

---

### 3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ email (case sensitivity)**
**–§–∞–π–ª:** `server/src/auth/auth.service.ts` (—Å—Ç—Ä–æ–∫–∞ 48-49, 112-113)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- Email –Ω–µ –ø—Ä–∏–≤–æ–¥–∏—Ç—Å—è –∫ lowercase –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
- –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ —Å –æ–¥–Ω–∏–º email –≤ —Ä–∞–∑–Ω–æ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `User@Example.com` –∏ `user@example.com`)
- –ü—Ä–∏ –ª–æ–≥–∏–Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º–∞, –µ—Å–ª–∏ email –≤–≤–µ–¥–µ–Ω –≤ –¥—Ä—É–≥–æ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```typescript
// –í register()
const existingUser = await tx.user.findFirst({
  where: { email: dto.email }, // ‚ö†Ô∏è –ù–µ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω
});

// –í login()
const user = await this.prisma.user.findFirst({
  where: { email: dto.email }, // ‚ö†Ô∏è –ù–µ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω
});
```

**–†–µ—à–µ–Ω–∏–µ:**
–ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å email –∫ lowercase:
```typescript
// –í register()
const normalizedEmail = dto.email.toLowerCase().trim();
const existingUser = await tx.user.findFirst({
  where: { email: normalizedEmail },
});

// –°–æ—Ö—Ä–∞–Ω—è—Ç—å –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π email
const user = await tx.user.create({
  data: {
    email: normalizedEmail,
    // ...
  },
});

// –í login()
const normalizedEmail = dto.email.toLowerCase().trim();
const user = await this.prisma.user.findFirst({
  where: { email: normalizedEmail },
});
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–π (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å - –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–æ–≤)

---

### 4. **–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å null company –≤ login()**
**–§–∞–π–ª:** `server/src/auth/auth.service.ts` (—Å—Ç—Ä–æ–∫–∞ 149-152)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –í `login()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `user.company.id` –∏ `user.company.name` –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ null
- –ï—Å–ª–∏ company –±—ã–ª–∞ —É–¥–∞–ª–µ–Ω–∞ –∏–ª–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞, –±—É–¥–µ—Ç runtime error

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```typescript
company: {
  id: user.company.id, // ‚ö†Ô∏è –ú–æ–∂–µ—Ç –±—ã—Ç—å null
  name: user.company.name, // ‚ö†Ô∏è –ú–æ–∂–µ—Ç –±—ã—Ç—å null
},
```

**–†–µ—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ null:
```typescript
if (!user.company) {
  throw new UnauthorizedException('User company not found');
}

return {
  user: {
    // ...
    company: {
      id: user.company.id,
      name: user.company.name,
    },
  },
  access_token: this.jwtService.sign(payload),
};
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–π (–º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å runtime error)

---

### 5. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ null payload.sub –≤ JWT strategy**
**–§–∞–π–ª:** `server/src/auth/strategies/jwt.strategy.ts` (—Å—Ç—Ä–æ–∫–∞ 33-34)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `payload.sub` –º–æ–∂–µ—Ç –±—ã—Ç—å undefined –∏–ª–∏ null
- `findUnique` —Å null/undefined –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –æ—à–∏–±–∫—É –∏–ª–∏ –≤–µ—Ä–Ω—É—Ç—å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```typescript
async validate(payload: any) {
  const user = await this.prisma.user.findUnique({
    where: { id: payload.sub }, // ‚ö†Ô∏è –ú–æ–∂–µ—Ç –±—ã—Ç—å null/undefined
    // ...
  });
}
```

**–†–µ—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É:
```typescript
async validate(payload: any) {
  if (!payload || !payload.sub) {
    throw new UnauthorizedException('Invalid token payload');
  }

  const user = await this.prisma.user.findUnique({
    where: { id: payload.sub },
    // ...
  });
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–π (–º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å runtime error)

---

## üü° –°—Ä–µ–¥–Ω–∏–µ –±–∞–≥–∏

### 6. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É –ø–∞—Ä–æ–ª—è**
**–§–∞–π–ª:** `server/src/auth/dto/register.dto.ts` (—Å—Ç—Ä–æ–∫–∞ 13), `server/src/auth/auth.service.ts` (—Å—Ç—Ä–æ–∫–∞ 17)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É –ø–∞—Ä–æ–ª—è
- –û—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –ø—Ä–∏ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–∏
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –¥–ª—è DoS –∞—Ç–∞–∫–∏

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```typescript
@MinLength(8, { message: 'Password must be at least 8 characters long' })
password: string;
```

**–†–µ—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã:
```typescript
@MinLength(8, { message: 'Password must be at least 8 characters long' })
@MaxLength(128, { message: 'Password must not exceed 128 characters' })
password: string;
```

–ò –≤ —Å–µ—Ä–≤–∏—Å–µ:
```typescript
if (dto.password.length < 8) {
  throw new BadRequestException('Password must be at least 8 characters long');
}
if (dto.password.length > 128) {
  throw new BadRequestException('Password must not exceed 128 characters');
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –°—Ä–µ–¥–Ω–∏–π (DoS –∑–∞—â–∏—Ç–∞)

---

### 7. **–ü—Ä–æ–±–ª–µ–º–∞ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π companyDomain - –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ –≤–º–µ—Å—Ç–æ null**
**–§–∞–π–ª:** `server/src/auth/auth.service.ts` (—Å—Ç—Ä–æ–∫–∞ 56-64)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ï—Å–ª–∏ `companyDomain` –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∫–∞–∫ –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ `""`, –ø—Ä–æ–≤–µ—Ä–∫–∞ `if (dto.companyDomain)` –ø—Ä–æ–π–¥–µ—Ç, –Ω–æ –∑–∞—Ç–µ–º –±—É–¥–µ—Ç –ø–æ–ø—ã—Ç–∫–∞ –Ω–∞–π—Ç–∏ –∫–æ–º–ø–∞–Ω–∏—é —Å –ø—É—Å—Ç—ã–º –¥–æ–º–µ–Ω–æ–º
- –ú–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ–º—É –ø–æ–≤–µ–¥–µ–Ω–∏—é

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```typescript
if (dto.companyDomain) {
  const existingCompany = await tx.company.findUnique({
    where: { domain: dto.companyDomain }, // ‚ö†Ô∏è –ú–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞
  });
}
```

**–†–µ—à–µ–Ω–∏–µ:**
–ü—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞ –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É:
```typescript
if (dto.companyDomain && dto.companyDomain.trim() !== '') {
  const normalizedDomain = dto.companyDomain.trim().toLowerCase();
  const existingCompany = await tx.company.findUnique({
    where: { domain: normalizedDomain },
  });
  // ...
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –°—Ä–µ–¥–Ω–∏–π (–≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö)

---

### 8. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ null –≤ validateUser()**
**–§–∞–π–ª:** `server/src/auth/auth.service.ts` (—Å—Ç—Ä–æ–∫–∞ 158-180)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `validateUser()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `user`, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –±—ã—Ç—å null
- –í—ã–∑—ã–≤–∞—é—â–∏–π –∫–æ–¥ –º–æ–∂–µ—Ç –Ω–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ null

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```typescript
async validateUser(userId: string) {
  const user = await this.prisma.user.findUnique({
    where: { id: userId },
    // ...
  });

  return user; // ‚ö†Ô∏è –ú–æ–∂–µ—Ç –±—ã—Ç—å null
}
```

**–†–µ—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∏–ª–∏ —è–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:
```typescript
async validateUser(userId: string) {
  if (!userId) {
    return null;
  }

  const user = await this.prisma.user.findUnique({
    where: { id: userId },
    // ...
  });

  return user; // –ú–æ–∂–µ—Ç –±—ã—Ç—å null - —ç—Ç–æ –æ–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –°—Ä–µ–¥–Ω–∏–π (–ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å null)

---

### 9. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É email**
**–§–∞–π–ª:** `server/src/auth/dto/register.dto.ts` (—Å—Ç—Ä–æ–∫–∞ 9), `server/src/auth/dto/login.dto.ts` (—Å—Ç—Ä–æ–∫–∞ 4)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É email
- –û—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã–π email –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```typescript
@IsEmail()
email: string;
```

**–†–µ—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã:
```typescript
@IsEmail()
@MaxLength(255, { message: 'Email must not exceed 255 characters' })
email: string;
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –°—Ä–µ–¥–Ω–∏–π (–≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö)

---

## üü¢ –ù–∏–∑–∫–∏–µ –±–∞–≥–∏ / –£–ª—É—á—à–µ–Ω–∏—è

### 10. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞**
**–§–∞–π–ª:** `server/src/auth/auth.service.ts` (—Å—Ç—Ä–æ–∫–∞ 125-126)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –Ω–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞
- –°–ª–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```typescript
if (!user || !isPasswordValid) {
  throw new UnauthorizedException('Invalid credentials');
}
```

**–†–µ—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
```typescript
if (!user || !isPasswordValid) {
  this.logger.warn({
    email: dto.email,
    hasUser: !!user,
    isPasswordValid,
  }, 'Failed login attempt');
  throw new UnauthorizedException('Invalid credentials');
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –ù–∏–∑–∫–∏–π (—É–ª—É—á—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)

---

### 11. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É –∏–º–µ–Ω–∏ –∏ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–º–ø–∞–Ω–∏–∏**
**–§–∞–π–ª:** `server/src/auth/dto/register.dto.ts` (—Å—Ç—Ä–æ–∫–∞ 5-7, 16-18)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É –¥–ª—è `name` –∏ `companyName`
- –ú–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```typescript
@IsString()
@MinLength(2)
name: string;

@IsString()
@MinLength(2)
companyName: string;
```

**–†–µ—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã:
```typescript
@IsString()
@MinLength(2)
@MaxLength(255)
name: string;

@IsString()
@MinLength(2)
@MaxLength(255)
companyName: string;
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –ù–∏–∑–∫–∏–π (–≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö)

---

### 12. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å JWT —Ç–æ–∫–µ–Ω–∞ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º**
**–§–∞–π–ª:** `server/src/auth/strategies/jwt.strategy.ts` (—Å—Ç—Ä–æ–∫–∞ 32)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `payload` –∏–º–µ–µ—Ç —Ç–∏–ø `any`, –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ–¥–∞–Ω –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π payload

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```typescript
async validate(payload: any) {
  const user = await this.prisma.user.findUnique({
    where: { id: payload.sub },
    // ...
  });
}
```

**–†–µ—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Å—Ç—Ä—É–∫—Ç—É—Ä—ã payload:
```typescript
interface JwtPayload {
  sub: string;
  email?: string;
  companyId?: string;
  iat?: number;
  exp?: number;
}

async validate(payload: JwtPayload) {
  if (!payload || !payload.sub) {
    throw new UnauthorizedException('Invalid token payload');
  }
  // ...
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –ù–∏–∑–∫–∏–π (—É–ª—É—á—à–µ–Ω–∏–µ —Ç–∏–ø–∏–∑–∞—Ü–∏–∏)

---

### 13. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –∏—Å—Ç–µ—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –≤ validate()**
**–§–∞–π–ª:** `server/src/auth/strategies/jwt.strategy.ts` (—Å—Ç—Ä–æ–∫–∞ 18)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `ignoreExpiration: false` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –Ω–æ –Ω–µ—Ç —è–≤–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ `validate()`
- –•–æ—Ç—è Passport –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–≤–µ—Ä—è—Ç—å expiration –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –ª—É—á—à–µ –¥–æ–±–∞–≤–∏—Ç—å —è–≤–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```typescript
super({
  jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),
  ignoreExpiration: false, // ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
  // ...
});
```

**–†–µ—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å —è–≤–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
```typescript
async validate(payload: JwtPayload) {
  if (payload.exp && payload.exp < Date.now() / 1000) {
    throw new UnauthorizedException('Token expired');
  }
  // ...
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –ù–∏–∑–∫–∏–π (—É–ª—É—á—à–µ–Ω–∏–µ - —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ Passport)

---

## üìã –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞

| #   | –ë–∞–≥                                            | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç    | –§–∞–π–ª                           | –°—Ç–∞—Ç—É—Å          |
| --- | ---------------------------------------------- | ------------ | ------------------------------ | --------------- |
| 1   | –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞—â–∏—Ç—ã –æ—Ç brute force               | üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–π | `auth.controller.ts:17`        | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
| 2   | –ü—Ä–æ–±–ª–µ–º–∞ —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º dummy hash               | üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–π | `auth.service.ts:121`          | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
| 3   | –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ email                  | üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–π | `auth.service.ts:48,112`       | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
| 4   | –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å null company          | üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–π | `auth.service.ts:149`          | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
| 5   | –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ null payload.sub        | üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–π | `jwt.strategy.ts:33`           | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
| 6   | –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É –ø–∞—Ä–æ–ª—è | üü° –°—Ä–µ–¥–Ω–∏–π   | `register.dto.ts:13`           | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
| 7   | –ü—Ä–æ–±–ª–µ–º–∞ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π companyDomain            | üü° –°—Ä–µ–¥–Ω–∏–π   | `auth.service.ts:56`           | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
| 8   | –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ null –≤ validateUser()   | üü° –°—Ä–µ–¥–Ω–∏–π   | `auth.service.ts:158`          | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
| 9   | –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É email | üü° –°—Ä–µ–¥–Ω–∏–π   | `register.dto.ts:9`            | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
| 10  | –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫       | üü¢ –ù–∏–∑–∫–∏–π    | `auth.service.ts:125`          | ‚ö†Ô∏è –ú–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å |
| 11  | –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É –∏–º–µ–Ω–∏ | üü¢ –ù–∏–∑–∫–∏–π    | `register.dto.ts:5`            | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
| 12  | –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã payload           | üü¢ –ù–∏–∑–∫–∏–π    | `jwt.strategy.ts:32`           | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
| 13  | –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —è–≤–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ expiration           | üü¢ –ù–∏–∑–∫–∏–π    | `jwt.strategy.ts:18`           | ‚ö†Ô∏è –ú–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å |

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö—Ä–∏—Ç–∏—á–Ω—ã–π): ‚úÖ –í–°–ï –ò–°–ü–†–ê–í–õ–ï–ù–û

1. ‚úÖ **–î–æ–±–∞–≤–∏—Ç—å rate limiting –¥–ª—è login/register** - **–ò–°–ü–†–ê–í–õ–ï–ù–û**
2. ‚úÖ **–ò—Å–ø—Ä–∞–≤–∏—Ç—å dummy hash –Ω–∞ –≤–∞–ª–∏–¥–Ω—ã–π bcrypt hash** - **–ò–°–ü–†–ê–í–õ–ï–ù–û**
3. ‚úÖ **–î–æ–±–∞–≤–∏—Ç—å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é email –∫ lowercase** - **–ò–°–ü–†–ê–í–õ–ï–ù–û**
4. ‚úÖ **–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ null company –≤ login()** - **–ò–°–ü–†–ê–í–õ–ï–ù–û**
5. ‚úÖ **–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ null payload.sub –≤ JWT strategy** - **–ò–°–ü–†–ê–í–õ–ï–ù–û**

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–°—Ä–µ–¥–Ω–∏–π): ‚úÖ –í–°–ï –ò–°–ü–†–ê–í–õ–ï–ù–û

6. ‚úÖ **–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É –ø–∞—Ä–æ–ª—è** - **–ò–°–ü–†–ê–í–õ–ï–ù–û**
7. ‚úÖ **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é companyDomain (–ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞)** - **–ò–°–ü–†–ê–í–õ–ï–ù–û**
8. ‚úÖ **–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ null –≤ validateUser()** - **–ò–°–ü–†–ê–í–õ–ï–ù–û**
9. ‚úÖ **–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É email** - **–ò–°–ü–†–ê–í–õ–ï–ù–û**

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–ù–∏–∑–∫–∏–π): ‚úÖ –ë–û–õ–¨–®–ò–ù–°–¢–í–û –ò–°–ü–†–ê–í–õ–ï–ù–û

10. üìù **–î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞** - ‚ö†Ô∏è –ú–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å
11. ‚úÖ **–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É –∏–º–µ–Ω–∏** - **–ò–°–ü–†–ê–í–õ–ï–ù–û**
12. ‚úÖ **–£–ª—É—á—à–∏—Ç—å —Ç–∏–ø–∏–∑–∞—Ü–∏—é JWT payload** - **–ò–°–ü–†–ê–í–õ–ï–ù–û** (–¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã)
13. üìù **–î–æ–±–∞–≤–∏—Ç—å —è–≤–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É expiration (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)** - ‚ö†Ô∏è –ú–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å (—É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ Passport)

---

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –±–∞–≥–∏:** 5 ‚úÖ –í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
**–°—Ä–µ–¥–Ω–∏–µ –±–∞–≥–∏:** 4 ‚úÖ –í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
**–ù–∏–∑–∫–∏–µ –±–∞–≥–∏/—É–ª—É—á—à–µ–Ω–∏—è:** 4 ‚úÖ –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**
1. ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞—â–∏—Ç—ã –æ—Ç brute force –∞—Ç–∞–∫ - **–ò–°–ü–†–ê–í–õ–ï–ù–û** (–¥–æ–±–∞–≤–ª–µ–Ω rate limiting)
2. ‚úÖ –ü—Ä–æ–±–ª–µ–º—ã —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π email - **–ò–°–ü–†–ê–í–õ–ï–ù–û** (–¥–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è)
3. ‚úÖ –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å null/undefined - **–ò–°–ü–†–ê–í–õ–ï–ù–û** (–¥–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏)
4. ‚úÖ –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π dummy hash –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç timing attacks - **–ò–°–ü–†–ê–í–õ–ï–ù–û** (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –≤–∞–ª–∏–¥–Ω—ã–π hash)

**–°—Ç–∞—Ç—É—Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**
- ‚úÖ –ë–∞–≥–∏ #1-5 (–∫—Ä–∏—Ç–∏—á–Ω—ã–µ) - **–ò–°–ü–†–ê–í–õ–ï–ù–´**
- ‚úÖ –ë–∞–≥–∏ #6-9 (—Å—Ä–µ–¥–Ω–∏–µ) - **–ò–°–ü–†–ê–í–õ–ï–ù–´**
- ‚úÖ –ë–∞–≥–∏ #11-12 (–Ω–∏–∑–∫–∏–µ) - **–ò–°–ü–†–ê–í–õ–ï–ù–´**
- ‚ö†Ô∏è –ë–∞–≥–∏ #10, #13 (–Ω–∏–∑–∫–∏–µ) - –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å –ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

**–û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω rate limiting (5 –ø–æ–ø—ã—Ç–æ–∫/–º–∏–Ω –¥–ª—è login, 3 –¥–ª—è register)
2. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω dummy hash –Ω–∞ –≤–∞–ª–∏–¥–Ω—ã–π bcrypt hash
3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è email –∫ lowercase –≤ register() –∏ login()
4. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ null company –≤ login()
5. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ null payload.sub –≤ JWT strategy
6. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É –ø–∞—Ä–æ–ª—è (128 —Å–∏–º–≤–æ–ª–æ–≤)
7. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è companyDomain (–ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É)
8. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ null –≤ validateUser()
9. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É email (255 —Å–∏–º–≤–æ–ª–æ–≤)
10. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É –∏–º–µ–Ω–∏ –∏ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–º–ø–∞–Ω–∏–∏ (255 —Å–∏–º–≤–æ–ª–æ–≤)
11. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã payload –≤ JWT strategy

