# üêõ –ù–∞–π–¥–µ–Ω–Ω—ã–µ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –±–∞–≥–∏

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ —ç—Ç–æ–º —Å–µ–∞–Ω—Å–µ

### 1. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–∞—Å—Å–∏–≤–æ–≤ –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º –º–µ—Ç–æ–¥–æ–≤**
**–ü—Ä–æ–±–ª–µ–º–∞:** –í –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö –∫–æ–¥–∞ –º–∞—Å—Å–∏–≤—ã (`projects`, `users`, `timeEntries`) –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ `null`/`undefined` –∏–ª–∏ —á—Ç–æ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –º–∞—Å—Å–∏–≤. –≠—Ç–æ –º–æ–≥–ª–æ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –æ—à–∏–±–∫–∞–º —Ç–∏–ø–∞ "Cannot read property 'find' of undefined" –∏–ª–∏ "projects.filter is not a function".

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ —Ñ–∞–π–ª–∞—Ö:**
- `components/TimeTracker.tsx` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `projects` –ø–µ—Ä–µ–¥ `.find()` (—Å—Ç—Ä–æ–∫–∞ 303)
- `components/Charts/ProjectChart.tsx` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `projects` –∏ `timeEntries` –ø–µ—Ä–µ–¥ `.filter()`
- `components/admin/ExportDialog.tsx` - –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è `projects` –∏ `users` –≤ `useEffect` –∏ –ø—Ä–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–µ
- `components/TimeEntriesTable.tsx` - –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è `projects` –∏ `users` –≤ `useEffect` –∏ –ø—Ä–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–µ
- `components/ActiveUsers.tsx` - –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è `users` –∏ `timeEntries` –ø–µ—Ä–µ–¥ `.filter()`, `.some()`, `.find()`
- `components/Charts/HourlyChart.tsx` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `timeEntries` –ø–µ—Ä–µ–¥ `.filter()`
- `components/Charts/DailyChart.tsx` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `timeEntries` –ø–µ—Ä–µ–¥ `.filter()`
- `components/Charts/MonthlyChart.tsx` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `timeEntries` –ø–µ—Ä–µ–¥ `.filter()`

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–∏–¥–∞:
```typescript
// –í–º–µ—Å—Ç–æ:
projects.find(...)

// –¢–µ–ø–µ—Ä—å:
if (!projects || !Array.isArray(projects)) {
  return; // –∏–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏
}
projects.find(...)

// –ò–ª–∏ –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞:
{projects && Array.isArray(projects) && projects.map(...)}
```

---

### 2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ loadProjects**
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –æ—à–∏–±–∫–µ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤ –º–∞—Å—Å–∏–≤ `projects` —Å–±—Ä–∞—Å—ã–≤–∞–ª—Å—è –≤ –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤, —á—Ç–æ –º–æ–≥–ª–æ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø–æ–ª–æ–º–∫–µ UI (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ —É —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –±—ã–ª –≤—ã–±—Ä–∞–Ω –ø—Ä–æ–µ–∫—Ç, –∞ –∑–∞—Ç–µ–º –ø—Ä–æ–∏–∑–æ—à–ª–∞ –≤—Ä–µ–º–µ–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ —Å–µ—Ç–∏).

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ —Ñ–∞–π–ª–µ:** `lib/store.ts` (–º–µ—Ç–æ–¥ `loadProjects`)

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ –æ—Ç API (–ø—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ —ç—Ç–æ –º–∞—Å—Å–∏–≤)
- –ü—Ä–∏ –æ—à–∏–±–∫–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `projects` (–µ—Å–ª–∏ –æ–Ω–æ –±—ã–ª–æ), –≤–º–µ—Å—Ç–æ —Å–±—Ä–æ—Å–∞ –≤ –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤
- –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª–æ–º–∫—É UI –ø—Ä–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–∫–∞—Ö

**–ö–æ–¥:**
```typescript
catch (error: any) {
  // Don't clear existing projects on error - keep previous state
  // This prevents UI from breaking if a temporary network error occurs
  const currentState = get();
  console.error('Failed to load projects:', error);
  set({ 
    error: error.message || 'Failed to load projects', 
    isLoading: false,
    // Keep existing projects if available, otherwise set to empty array
    projects: currentState.projects.length > 0 ? currentState.projects : []
  });
}
```

---

## üìã –†–µ–∑—é–º–µ

–í—Å–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å–≤—è–∑–∞–Ω—ã —Å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ–º –ø—Ä–æ–≤–µ—Ä–æ–∫ –Ω–∞ `null`/`undefined` –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–æ–≤ –º–∞—Å—Å–∏–≤–æ–≤. –≠—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏:
- –û—à–∏–±–∫–∞—Ö —Å–µ—Ç–∏
- –ú–µ–¥–ª–µ–Ω–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö
- –ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö –æ—Ç–≤–µ—Ç–æ–≤ –æ—Ç API
- Race conditions –ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö

–í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã –∏ –Ω–µ –∏–∑–º–µ–Ω—è—é—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –ª–æ–≥–∏–∫—É —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

