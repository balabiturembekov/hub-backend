# üìä –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2025-11-07  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ**

## üìà –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–ü–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:** 9 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
- **–°—Ç–∞—Ç—É—Å:** –í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ
- **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏:** ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç
- **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è:** ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç

---

## ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ

### 1. **CORS –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**
- ‚úÖ –ó–∞–ø—Ä–æ—Å—ã —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (`https://hubnity.automatonsoft.de`) –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ
- ‚úÖ Health checks –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∑–∞–ø—Ä–æ—Å—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –ø—Ä–æ–±–ª–µ–º

**–ü—Ä–∏–º–µ—Ä—ã –∏–∑ –ª–æ–≥–æ–≤:**
```
CORS: Allowing origin: https://hubnity.automatonsoft.de
CORS: Allowing request with no origin (likely health check or internal request)
WebSocket CORS: Allowing origin: https://hubnity.automatonsoft.de
```

### 2. **HTTP –∑–∞–ø—Ä–æ—Å—ã**
- ‚úÖ –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —É—Å–ø–µ—à–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã:
  - `200 OK` - —É—Å–ø–µ—à–Ω—ã–µ GET –∑–∞–ø—Ä–æ—Å—ã
  - `201 Created` - —É—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
  - `304 Not Modified` - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ –æ—Ç–ª–∏—á–Ω–æ–µ:
  - –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤: **6-27ms**
  - –°–æ–∑–¥–∞–Ω–∏–µ time entry: **17-212ms** (–Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –∑–∞–ø–∏—Å–∏ –≤ –ë–î)

**–ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**
```
GET /api/projects - 10-19ms
GET /api/time-entries/my - 6-23ms
GET /api/time-entries/active - 7-12ms
POST /api/time-entries - 17-212ms
```

### 3. **WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**
- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
- ‚úÖ –û—Ç–∫–ª—é—á–µ–Ω–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è –∫ —Å–≤–æ–∏–º –∫–æ–º–ø–∞–Ω–∏—è–º

**–ü—Ä–∏–º–µ—Ä—ã:**
```
Client 9ZtV0fdn-rCpPEk8AABZ connected (User: yana.galchenko.01@list.ru, Company: c3738440-8956-4713-8976-3e217d7b3359)
Client JcVQAUgtOx2Zt7eqAABb connected (User: yana.galchenko.01@list.ru, Company: c3738440-8956-4713-8976-3e217d7b3359)
```

### 4. **API endpoints**
–í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ endpoints —Ä–∞–±–æ—Ç–∞—é—Ç:
- ‚úÖ `/api/auth/login` - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- ‚úÖ `/api/projects` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–≤
- ‚úÖ `/api/time-entries` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å—è–º–∏ –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ `/api/time-entries/activities` - –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ `/api/companies/screenshot-settings` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤

---

## üîç –ù–∞–±–ª—é–¥–µ–Ω–∏—è (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)

### 1. **–ó–∞–ø—Ä–æ—Å—ã –±–µ–∑ Origin –∑–∞–≥–æ–ª–æ–≤–∫–∞**
- –ú–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –±–µ–∑ `Origin` –∑–∞–≥–æ–ª–æ–≤–∫–∞
- –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è:
  - Health checks
  - –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç Nginx
  - –ù–µ–∫–æ—Ç–æ—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –±–ª–∞–≥–æ–¥–∞—Ä—è –Ω–∞—à–µ–π CORS –ª–æ–≥–∏–∫–µ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Nginx –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ `Origin` –∑–∞–≥–æ–ª–æ–≤–∫–∞, –Ω–æ —ç—Ç–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.

### 2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ WebSocket –æ—Ç–∫–ª—é—á–µ–Ω–∏–π**
- –ü—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ `userId`, –∞ –Ω–µ email
- –ü—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è email
- –≠—Ç–æ –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞, –Ω–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```typescript
// –ü—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ - email
Client connected (User: yana.galchenko.01@list.ru, Company: ...)

// –ü—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏ - userId
Client disconnected (User: ab9e260b-76ca-4eb6-90b1-afed4d5d2e38)
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ú–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å email –≤ `client.data` –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏.

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|---------|----------|--------|
| –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ GET | 6-27ms | ‚úÖ –û—Ç–ª–∏—á–Ω–æ |
| –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ POST | 17-212ms | ‚úÖ –ù–æ—Ä–º–∞–ª—å–Ω–æ |
| –£—Å–ø–µ—à–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤ | 100% | ‚úÖ –û—Ç–ª–∏—á–Ω–æ |
| CORS –æ—à–∏–±–∫–∏ | 0 | ‚úÖ –û—Ç–ª–∏—á–Ω–æ |
| WebSocket –æ—à–∏–±–∫–∏ | 0 | ‚úÖ –û—Ç–ª–∏—á–Ω–æ |

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### 1. **–£–ª—É—á—à–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è WebSocket**
–ú–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–π –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏:

```typescript
// –í events.gateway.ts, handleConnection
client.data.userEmail = user.email; // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å email

// –í handleDisconnect
this.logger.log(`Client ${client.id} disconnected (User: ${client.data.userEmail || client.data.userId})`);
```

### 2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**
- –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –¥–ª—è –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (>500ms)
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
- –î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏ –∏ CPU

### 3. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤**
- –ó–∞–ø—Ä–æ—Å—ã —Å –≤—Ä–µ–º–µ–Ω–µ–º –æ—Ç–≤–µ—Ç–∞ >200ms –º–æ–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å:
  - –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –≤ –ë–î
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î

---

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–°—Ç–∞—Ç—É—Å:** üü¢ **–í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ**

- –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ—Ç–ª–∏—á–Ω–∞—è
- CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- WebSocket —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
- –í—Å–µ API endpoints —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ!** üéâ

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

1. ‚úÖ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤
2. ‚ö†Ô∏è –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å —É–ª—É—á—à–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è WebSocket –æ—Ç–∫–ª—é—á–µ–Ω–∏–π
3. ‚ö†Ô∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã (Sentry —É–∂–µ –ø–æ–¥–∫–ª—é—á–µ–Ω)
4. ‚ö†Ô∏è –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

